![[Pasted image 20231209221537.png]]
비둘기집의 원리

salt size = hash size

DB size = RSAKEYSIZE - HASHSIZE - 1

인증은 모든 비트를 인증값으로 쓰지 않는다

해쉬 함수를 통과한 값만 암호화 한다
짧지만 대체 가능
어차피 해시 충돌을 찾기는 어렵다

피딩 1 = 8바이트 00 00 00 00 00 00 00 00

패딩 2의 길이는 조절됨
키에 따라서 조절


salt 값을 뽑아서 가져오고 서명을 한 해시값과 아래에서 풀어서 나온 해시값과 비교

EM 의 MSB 가 1이면 강제로 0으로 설정한다.

복원할 필요가 없다. 그러므로 강제로 변환 가능

TF  = 트레일러 필드. 1바이트 크기. 0xbc. 1011 1100
얘를 넣음으로써 서명을 풀었을 때 오류가 있는지 없는지 확인하는 용도

### 복호화
![[Pasted image 20231210134902.png]]