![[Pasted image 20231114221552.png]]

$GCTR_K(ICB, X)$
비밀 키 K와 임의 길이의 비트 문자열 X를 입력으로 하여, 비트 길이가 $len(X)$ 인 암호문 $Y$ 를 반환한다.

1. X가 빈 문자열이면, 빈 문자열 Y를 반환한다.
2. $n = \lceil \frac{len(X)}{128} \rceil$ 이라 하자. 
3. $X_1, X_2, \cdots, X_{n-1}, X_n^*$ 가 다음을 만족하는 고유한 일련의 비트 문자열이라고 할 때, $X_1, X_2, \cdots, X_{n-1}, X_n^*$는 완전한 128 비트 블럭들이다. $$X = X_1|| X_2|| \cdots|| X_{n-1}|| X_n^*$$
4. $CB_1 = ICB$ 라 하자.
5. i = 2 부터 n에 대하여, $CB_i = inc_{32}(CB_{i-1})$ 라 할 때, 여기서 $inc_{32}(S)$ 는 S의 가장 오른쪽 32비트를 $1\, mod\, 2^{32}$ 만큼 증가시키고, 나머지 비트들은 변경되지 않는다.
6. i = 1 부터 n-1 에 대하여, $Y_i = X_i \oplus E(K, CB_i)$ 를 수행한다.
7. $Y_n^* = X_n^* \oplus MSB_{len(X_n^*)}(E(K,CB_n))$ 을 얻는다.
8. $Y = Y_1 || Y_2 || \cdots || Y_n^*$ 라 하자.
9. Y를 반환한다.

카운터 값들이 빠르게 생성되고, 암호화 연산이 병렬로 수행될 수 있음에 주목